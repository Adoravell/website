import{_ as e,c as a,o as t,X as o}from"./chunks/framework.43b9ffd8.js";const g=JSON.parse('{"title":"Contribute","description":"Find out how to help translate or build the app and parsers.","frontmatter":{"title":"Contribute","description":"Find out how to help translate or build the app and parsers.","footer":false},"headers":[],"relativePath":"dev/contribute/index.md","filePath":"dev/contribute/index.md","lastUpdated":1711086010000,"breadcrumbs":[{"text":"For developers","items":[{"text":"Contribute","link":"/dev/contribute/"},{"text":"Parsers library","link":"/dev/parsers-library/"},{"text":"Synchronization server","link":"/dev/sync-server/"}]},{"text":"Contribute","link":"/dev/contribute/"}]}'),r={name:"dev/contribute/index.md"},s=o('<h1 id="contribute" tabindex="-1">Contribute <a class="header-anchor" href="#contribute" aria-label="Permalink to &quot;Contribute&quot;">​</a></h1><p>Find out how to help translate or build the app and parsers.</p><h2 id="app-contribution-guidelines" tabindex="-1">App contribution guidelines <a class="header-anchor" href="#app-contribution-guidelines" aria-label="Permalink to &quot;App contribution guidelines&quot;">​</a></h2><ul><li>If you want to fix bug or implement a new feature, that already mention in the <a href="https://github.com/KotatsuApp/Kotatsu/issues" target="_blank" rel="noreferrer">issues</a>, please, assign this issue to you and/or comment about it.</li><li>Whether you have to implement new feature, please, open an issue or discussion regarding it to ensure it will be accepted.</li><li>Translations have to be managed using the <a href="https://hosted.weblate.org/engage/kotatsu/" target="_blank" rel="noreferrer">Weblate</a> platform.</li><li>In case you want to add a new manga source, refer to the <a href="https://github.com/KotatsuApp/kotatsu-parsers" target="_blank" rel="noreferrer">parsers repository</a>.</li></ul><p>Refactoring or some dev-faces improvements are also might be accepted, however please stick to the following principles:</p><ul><li>Performance matters. In the case of choosing between source code beauty and performance, performance should be a priority.</li><li>Please, do not modify readme and other information files (except for typos).</li><li>Avoid adding new dependencies unless required. APK size is important.</li></ul><h2 id="parsers-contribution-guidelines" tabindex="-1">Parsers contribution guidelines <a class="header-anchor" href="#parsers-contribution-guidelines" aria-label="Permalink to &quot;Parsers contribution guidelines&quot;">​</a></h2><p>The following is guide for creating a Kotatsu parsers. Thanks for taking the time to contribute!</p><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><p>Before you start, please note that the ability to use following technologies is <strong>required</strong>.</p><ul><li>Basic <a href="https://developer.android.com/" target="_blank" rel="noreferrer">Android development</a></li><li><a href="https://kotlinlang.org/" target="_blank" rel="noreferrer">Kotlin</a></li><li>Web scraping (<a href="https://jsoup.org/" target="_blank" rel="noreferrer">JSoup</a>) or JSON API</li></ul><h4 id="tools" tabindex="-1">Tools <a class="header-anchor" href="#tools" aria-label="Permalink to &quot;Tools&quot;">​</a></h4><ul><li><a href="https://developer.android.com/studio" target="_blank" rel="noreferrer">Android Studio</a></li><li><a href="https://www.jetbrains.com/idea/" target="_blank" rel="noreferrer">IntelliJ IDEA</a> (Community edition is enough)</li><li>Android device (or emulator)</li></ul><p>Kotatsu parsers is not a part of Android application, but you can easily develop and test it directly inside an Android application project and relocate it to the library project when done.</p><h4 id="before-you-start" tabindex="-1">Before you start <a class="header-anchor" href="#before-you-start" aria-label="Permalink to &quot;Before you start&quot;">​</a></h4><p>First, take a look at <code>kotatsu-parsers</code> project structure. Each parser is a single class that extends <code>MangaParser</code> class and have a <code>MangaSourceParser</code> annotation. Also pay attention on extensions in <code>util</code> package. For example, extensions from <code>Jsoup</code> file should be used instead of existing JSoup functions because they have better nullability support and improved error messages.</p><h3 id="writing-your-parser" tabindex="-1">Writing your parser <a class="header-anchor" href="#writing-your-parser" aria-label="Permalink to &quot;Writing your parser&quot;">​</a></h3><p>So, you want to create a parser, that will provide access to manga from a website. First, you should explore a website for API availability. If it does not contain any documentation about API, <a href="https://firefox-source-docs.mozilla.org/devtools-user/" target="_blank" rel="noreferrer">explore network requests</a>: some websites use ajax.</p><ul><li><a href="https://github.com/KotatsuApp/kotatsu-parsers/blob/master/src/main/kotlin/org/koitharu/kotatsu/parsers/site/ru/DesuMeParser.kt" target="_blank" rel="noreferrer">Example</a> of Json API usage.</li><li><a href="https://github.com/KotatsuApp/kotatsu-parsers/blob/master/src/main/kotlin/org/koitharu/kotatsu/parsers/site/be/AnibelParser.kt" target="_blank" rel="noreferrer">Example</a> of GraphQL API usage</li><li><a href="https://github.com/KotatsuApp/kotatsu-parsers/blob/master/src/main/kotlin/org/koitharu/kotatsu/parsers/site/en/MangaTownParser.kt" target="_blank" rel="noreferrer">Example</a> of pure HTML parsing.</li></ul><p>If website is based on some engine it is rationally to use common base class for this one (for example, Madara wordress theme and the <code>MadaraParser</code> class)</p><h4 id="parser-class-skeleton" tabindex="-1">Parser class skeleton <a class="header-anchor" href="#parser-class-skeleton" aria-label="Permalink to &quot;Parser class skeleton&quot;">​</a></h4><p>Parser class must have exactly one primary constructor parameter of type <code>MangaLoaderContext</code> and have an <code>MangaSourceParser</code> annotation that provides internal name, title and language of a manga source.</p><p>All functions in <code>MangaParser</code> class are documented. Pay attention to some peculiarities:</p><ul><li>Never hardcode domain. Specify default domain in <code>configKeyDomain</code> field and obtain an actual one using <code>getDomain()</code>.</li><li>All ids must be unique and domain-independent. Use <code>generateUid</code> functions with relative url or some internal id which is unique across the manga source.</li><li><code>sortOrders</code> set should not be empty. If your source is not support sorting, specify one most relevance value.</li><li>If you cannot obtain direct links to pages images inside <code>getPages</code> method, it is ok to use an intermediate url as <code>Page.url</code> and fetch a direct link at <code>getPageUrl</code> function.</li><li>You can use <em>asserts</em> to check some optional fields. For example. <code>Manga.author</code> field is not required, but if your source provide such information, add <code>assert(it != null)</code>. This will not have any effect on production but help to find issues during unit testing.</li><li>If your source website (or it&#39;s api) uses pages for pagination instead of offset you should extend <code>PagedMangaParser</code> instead of <code>MangaParser</code>.</li><li>Your parser may also implement the <code>Interceptor</code> interface for additional manipulation of all network requests and/or responses, including image loading.</li></ul><h3 id="development-process" tabindex="-1">Development process <a class="header-anchor" href="#development-process" aria-label="Permalink to &quot;Development process&quot;">​</a></h3><p>During the development it is recommended (but not necessary) to write it directly in the Kotatsu android application project. You can use <code>core.parser.DummyParser</code> class as a sandbox. <code>Dummy</code> manga source is available in debug Kotatsu build.</p><p>Once parser is ready you can relocate your code into <code>kotatsu-parsers</code> library project in a <code>site</code> package and create a Pull Request.</p><h4 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h4><p>It is recommended to run unit tests before submitting a PR.</p><ul><li>Temporary modify the <code>MangaSources</code> annotation class: specify your parser(s) name(s) and change mode to <code>EnumSource.Mode.INCLUDE</code></li><li>Run the <code>MangaParserTest</code></li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#61AFEF;">gradlew</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">:test</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">--tests</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;org.koitharu.kotatsu.parsers.MangaParserTest&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">gradlew</span><span style="color:#24292E;"> </span><span style="color:#032F62;">:test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--tests</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;org.koitharu.kotatsu.parsers.MangaParserTest&quot;</span></span></code></pre></div><ul><li>Optionally, you can run the <code>generateTestsReport</code> gradle task to get a pretty readable html report from test results.</li></ul><h2 id="help" tabindex="-1">Help <a class="header-anchor" href="#help" aria-label="Permalink to &quot;Help&quot;">​</a></h2><p>If you need a help or have some questions, ask a community in our <a href="https://t.me/kotatsuapp" target="_blank" rel="noreferrer">Telegram chat</a> or <a href="https://discord.gg/NNJ5RgVBC5" target="_blank" rel="noreferrer">Discord server</a>.</p>',34),i=[s];function n(l,d,c,u,p,h){return t(),a("div",null,i)}const b=e(r,[["render",n]]);export{g as __pageData,b as default};
